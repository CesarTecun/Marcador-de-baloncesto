{
	# Opcional: correo para notificaciones de certificados
	# email cesar@example.com
	# Habilitar opciones globales
	admin off
}

tobarumg.lat {
	encode zstd gzip
	# X-Forwarded y otras cabeceras Ãºtiles
	header {
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		Referrer-Policy "strict-origin-when-cross-origin"
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
	}

	# Forzar UTF-8 para contenidos textuales servidos por la UI
	@html path *.html
	header @html Content-Type "text/html; charset=utf-8"

	@css path *.css
	header @css Content-Type "text/css; charset=utf-8"

	@js path *.js
	header @js Content-Type "application/javascript; charset=utf-8"

	@json path *.json
	header @json Content-Type "application/json; charset=utf-8"

	@svg path *.svg
	header @svg Content-Type "image/svg+xml; charset=utf-8"

	# Enrutar API directo para evitar doble proxy (Caddy -> Nginx(UI) -> API)
	handle /api/* {
		reverse_proxy api:8080
	}
	# UI (Angular+Nginx en el servicio ui, puerto 80)
	reverse_proxy ui:80
}

api.tobarumg.lat {
	encode zstd gzip
	header {
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		Referrer-Policy "strict-origin-when-cross-origin"
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
	}
	# API ASP.NET en el servicio api, puerto 8080
	reverse_proxy api:8080
}
